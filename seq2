@startuml
actor "Вызывающая система" as kace
participant "client-registration" as kc
participant "client-service/v2" as client

database TDG as tdg

autonumber

==Создание Единорго профиля==

kace->kc ++: POST client-service/clients
note right
{
"name": "Наталья",
"login": "79263658989",
"birthday": "1996-05-21",
"mail": "test@mail.ru",
"mobilePhone": "79263658989",
"permissionMarketing": "N",
"userAgreementLoyaltyProgram": false,
"refusePrintReceipt": false
}
end note

kc->tdg: Создание профиля x5id
kc<-tdg: Профиль x5id создан
note left
{
 "x5id": 98758765
}
end note
kc->client++:  POST client-service/v2/clients
note right
{
  "profile": {
    "x5id": <созданный x5id>,
    "surname": <sg_user_profile.surname созданного профиля>,
    "firstName": <sg_user_profile.name созданного профиля>,
    "mobilePhone": <sg_user_profile.mobilePhone созданного профиля>,
    "sex": <sg_user_profile.sex созданного профиля>,
    "birthday": <sg_user_profile.birthday созданного профиля>,
    "email": <sg_user_profile.mail созданного профиля>
  }
}
end note
client->tdg: создание записи в customer_profiles
client<-tdg: запись создана
note left
{
"clientId": 42465634
}
end note

kc<-client--:  запись создана
note left
{
"clientId": 42465634
}
end note

kace<-kc: Профили созданы
note left
{
"clientId": 42465634,
 "x5id": 98758765
}
end note



@enduml
